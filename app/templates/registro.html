{% extends "base.html" %}
{% block titulo %}Registro - TiendaOnline{% endblock %}

{% block contenido %}
<div class="container">
    <div class="formulario-auth">
        <h2><i class="bi bi-person-plus"></i> Crear Cuenta</h2>
        <p class="subtitulo">Únete a TiendaOnline y disfruta de las mejores ofertas</p>

        <form action="{{ url_for('auth.registro') }}" method="POST" id="formRegistro" novalidate>
            <div class="form-flotante" id="grupoNombre">
                <label for="nombre">Nombre completo</label>
                <input type="text" id="nombre" name="nombre" value="{{ nombre|default('') }}"
                    placeholder="Tu nombre completo" required minlength="3">
                <div class="error-campo" id="errorNombre">El nombre debe tener al menos 3 caracteres</div>
            </div>

            <div class="form-flotante" id="grupoEmail">
                <label for="email">Correo electrónico</label>
                <input type="email" id="email" name="email" value="{{ email|default('') }}"
                    placeholder="tucorreo@ejemplo.com" required>
                <div class="error-campo" id="errorEmail">Ingresa un correo electrónico válido</div>
            </div>

            <div class="form-flotante" id="grupoPassword">
                <label for="password">Contraseña</label>
                <input type="password" id="password" name="password" placeholder="Mínimo 6 caracteres" required
                    minlength="6">
                <div class="error-campo" id="errorPassword">La contraseña debe tener al menos 6 caracteres</div>
            </div>

            <div class="form-flotante" id="grupoConfirmar">
                <label for="confirmar_password">Confirmar contraseña</label>
                <input type="password" id="confirmar_password" name="confirmar_password"
                    placeholder="Repite tu contraseña" required>
                <div class="error-campo" id="errorConfirmar">Las contraseñas no coinciden</div>
            </div>

            <button type="submit" class="btn-primario w-100 justify-content-center mt-3">
                <i class="bi bi-person-plus"></i> Registrarse
            </button>
        </form>

        <div class="text-center mt-3">
            <span style="color: var(--color-texto-claro);">¿Ya tienes cuenta?</span>
            <a href="{{ url_for('auth.login') }}">Iniciar Sesión</a>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts_extra %}
<script>
    document.getElementById('formRegistro').addEventListener('submit', function (e) {
        let valido = true;

        // Validar nombre
        const nombre = document.getElementById('nombre');
        const grupoNombre = document.getElementById('grupoNombre');
        if (nombre.value.trim().length < 3) {
            grupoNombre.classList.add('invalido');
            valido = false;
        } else {
            grupoNombre.classList.remove('invalido');
        }

        // Validar email
        const email = document.getElementById('email');
        const grupoEmail = document.getElementById('grupoEmail');
        const regexEmail = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!regexEmail.test(email.value)) {
            grupoEmail.classList.add('invalido');
            valido = false;
        } else {
            grupoEmail.classList.remove('invalido');
        }

        // Validar contraseña
        const password = document.getElementById('password');
        const grupoPassword = document.getElementById('grupoPassword');
        if (password.value.length < 6) {
            grupoPassword.classList.add('invalido');
            valido = false;
        } else {
            grupoPassword.classList.remove('invalido');
        }

        // Validar confirmación
        const confirmar = document.getElementById('confirmar_password');
        const grupoConfirmar = document.getElementById('grupoConfirmar');
        if (confirmar.value !== password.value) {
            grupoConfirmar.classList.add('invalido');
            valido = false;
        } else {
            grupoConfirmar.classList.remove('invalido');
        }

        if (!valido) e.preventDefault();
    });
</script>
{% endblock %}